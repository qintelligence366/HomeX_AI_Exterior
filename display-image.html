<!DOCTYPE html>
<html>
<body>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");
        let image = new Image();

        // 动态接收 URL 参数
        const params = new URLSearchParams(window.location.search);
        let imageUrl = params.get("imageUrl") || "https://via.placeholder.com/300";
        if (imageUrl && !imageUrl.includes("via.placeholder")) {
            if (!imageUrl.includes("auto=format")) {
                imageUrl += "?auto=format&q=20";
            }
        }
        image.src = imageUrl;

        image.onload = () => {
            const maxWidth = 300; // 调整为 WebView 宽度
            const scale = Math.min(maxWidth / image.width, 1);
            const newWidth = image.width * scale;
            const newHeight = image.height * scale;

            canvas.width = newWidth;
            canvas.height = newHeight;
            ctx.drawImage(image, 0, 0, newWidth, newHeight);
        };

        // 调试：打印 URL 到控制台
        console.log("Image URL:", imageUrl);
    </script>
</body>
</html>
